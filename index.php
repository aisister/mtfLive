<?php 
$c=array(
	'n'=>'直播 - Y站',
	'c'=>array(
		'blzy'=>array('n'=>'堡垒之夜'),
		'biaoyan'=>array('n'=>'表演'),
		'cf'=>array('n'=>'CF穿越火线'),
		'cf-sy'=>array('n'=>'CF穿越火线手游'),
		'chihewanle'=>array('n'=>'吃喝玩乐'),
		'cq'=>array('n'=>'传奇'),
		'czymf'=>array('n'=>'创造与魔法'),
		'dianshi'=>array('n'=>'电视','tip'=>'点开请等30秒，解除方向锁定，横向全屏看更好'),
		'doudizhu'=>array('n'=>'斗地主'),
		'dnf'=>array('n'=>'DNF地下城与勇士'),
		'dwrg'=>array('n'=>'第五人格'),
		'dota2'=>array('n'=>'DOTA2'),
		'ecy'=>array('n'=>'二次元'),
		'fifa'=>array('n'=>'FIFA'),
		'gedou'=>array('n'=>'格斗'),
		'gjqtwlb'=>array('n'=>'古剑奇谭网络版'),
		'gwlr'=>array('n'=>'怪物猎人'),
		'hpjy'=>array('n'=>'和平精英'),
		'huaijiu'=>array('n'=>'怀旧游戏'),
		'huwai'=>array('n'=>'户外'),
		'hyrz'=>array('n'=>'火影忍者'),
		'hyxd'=>array('n'=>'荒野行动'),
		'lanqiu'=>array('n'=>'篮球'),
		'jdqs'=>array('n'=>'绝地求生'),
		'jdqs-sy'=>array('n'=>'绝地求生手游'),
		'jl'=>array('n'=>'剑灵'),
		'jlbkm'=>array('n'=>'精灵宝可梦'),
		'jielan'=>array('n'=>'街篮'),
		'jlp'=>array('n'=>'纪录片'),
		'jpfc'=>array('n'=>'极品飞车'),
		'jw3'=>array('n'=>'剑网3'),
		'lol'=>array('n'=>'LOL英雄联盟'),
		'lrs'=>array('n'=>'狼人杀'),
		'lscs'=>array('n'=>'炉石传说'),
		'majiang'=>array('n'=>'麻将'),
		'meishi'=>array('n'=>'美食'),
		'mhls'=>array('n'=>'猫和老鼠'),
		'miniworld'=>array('n'=>'迷你世界'),
		'mszb'=>array('n'=>'魔兽争霸'),
		'nba2k'=>array('n'=>'NBA2K'),
		'nk'=>array('n'=>'奶块'),
		'nsh'=>array('n'=>'逆水寒'),
		'nz'=>array('n'=>'逆战'),
		'ppkdc'=>array('n'=>'跑跑卡丁车'),
		'qc'=>array('n'=>'汽车'),
		'qmqz'=>array('n'=>'全民枪战'),
		'qipai'=>array('n'=>'棋牌'),
		'qqfc'=>array('n'=>'QQ飞车'),
		'qqfc-sy'=>array('n'=>'QQ飞车手游'),
		'qiuqiu'=>array('n'=>'球球大作战'),
		'qqxw'=>array('n'=>'QQ炫舞'),
		'qqxw-sy'=>array('n'=>'QQ炫舞手游'),
		'roe'=>array('n'=>'ROE无限法则'),
		'sed'=>array('n'=>'塞尔达'),
		'sgs'=>array('n'=>'三国杀'),
		'shuma'=>array('n'=>'数码'),
		'srh'=>array('n'=>'赛尔号'),
		'swxf'=>array('n'=>'守望先锋'),
		'tksj'=>array('n'=>'坦克世界'),
		'ttkp'=>array('n'=>'天天酷跑'),
		'taiqiu'=>array('n'=>'台球'),
		'tymyd'=>array('n'=>'天涯明月刀'),
		'wudao'=>array('n'=>'舞蹈'),
		'wd'=>array('n'=>'问道'),
		'wd-sy'=>array('n'=>'问道手游'),
		'wdsj'=>array('n'=>'我的世界'),
		'wow'=>array('n'=>'WOW魔兽世界'),
		'wzry'=>array('n'=>'王者荣耀'),
		'xjzb'=>array('n'=>'星际争霸'),
		'xinyou'=>array('n'=>'新游'),
		'xy'=>array('n'=>'乡野'),
		'yhzr'=>array('n'=>'英魂之刃'),
		'yhzrkdb'=>array('n'=>'英魂之刃口袋版'),
		'yqlfc'=>array('n'=>'一起来飞车'),
		'yingshi'=>array('n'=>'影视'),
		'yinyue'=>array('n'=>'音乐'),
		'yuyin'=>array('n'=>'语音'),
		'yanzhi'=>array('n'=>'颜值'),
		'zhuji'=>array('n'=>'主机游戏'),
		'zhengnengliang'=>array('n'=>'正能量'),
		'zuqiu'=>array('n'=>'足球')
	),
	't'=>1800,//缓存过期时间
	'p'=>30,//每页30个
	'z'=>array(
		'douyu'=>array(
			't'=>'json',
			'd'=>'https://www.douyu.com',
			'z'=>'https://www.douyu.com/gapi/',
			'c'=>array(
				'blzy'=>'rkc/directory/2_347/1',
				'biaoyan'=>'rknc/directory/yzRec/1',
				'cf'=>'rkc/directory/2_33/1',
				'chihewanle'=>'rkc/directory/2_194/1',
				'cq'=>'rkc/directory/2_187/1',
				'czymf'=>'rkc/directory/2_371/1',
				'doudizhu'=>'rkc/directory/2_416/1',
				'dnf'=>'rkc/directory/2_40/1',
				'dota2'=>'rkc/directory/2_3/1',
				'ecy'=>'rkc/directory/2_174/1',
				'fifa'=>'rkc/directory/2_766/1',
				'gedou'=>'rkc/directory/2_29/1',
				'gjqtwlb'=>'rkc/directory/2_551/1',
				'gwlr'=>'rkc/directory/2_367/1',
				'hpjy'=>'rkc/directory/2_350/1',
				'huaijiu'=>'rkc/directory/2_26/1',
				'huwai'=>'rkc/directory/2_124/1',
				'hyrz'=>'rkc/directory/2_196/1',
				'jdqs'=>'rkc/directory/2_270/1',
				'jl'=>'rkc/directory/2_13/1',
				'jlbkm'=>'rkc/directory/2_843/1',
				'jlp'=>'rkc/directory/2_514/1',
				'jielan'=>'rkc/directory/2_244/1',
				'jpfc'=>'rkc/directory/2_488/1',
				'jw3'=>'rkc/directory/2_65/1',
				'lol'=>'rkc/directory/2_917/1',
				'lrs'=>'rkc/directory/2_260/1',
				'lscs'=>'rkc/directory/2_2/1',
				'majiang'=>'rkc/directory/2_451/1,rkc/directory/2_370/1',
				'meishi'=>'rkc/directory/2_194/1',
				'mhls'=>'rkc/directory/2_524/1',
				'miniworld'=>'rkc/directory/2_273/1',
				'mszb'=>'rkc/directory/2_55/1',
				'nba2k'=>'rkc/directory/2_438/1',
				'nsh'=>'rkc/directory/2_434/1',
				'nz'=>'rkc/directory/2_46/1',
				'ppkdc'=>'rkc/directory/2_90/1,rkc/directory/2_654/1',
				'qc'=>'rkc/directory/2_136/1',
				'qipai'=>'rkc/directory/2_113/1',
				'qqfc'=>'rkc/directory/2_375/1',
				'qqfc-sy'=>'rkc/directory/2_331/1',
				'qiuqiu'=>'rkc/directory/2_192/1',
				'qqxw'=>'rkc/directory/2_710/1',
				'qqxw-sy'=>'rkc/directory/2_394/1',
				'sed'=>'rkc/directory/2_699/1',
				'sgs'=>'rkc/directory/2_14/1,rkc/directory/2_657/1',
				'shuma'=>'rkc/directory/2_134/1',	
				'srh'=>'rkc/directory/2_339/1,rkc/directory/2_576/1',
				'swxf'=>'rkc/directory/2_148/1',
				'tymyd'=>'rkc/directory/2_59/1',
				'ttkp'=>'rkc/directory/2_456/1',
				'wudao'=>'rkc/directory/2_1008/1',
				'wd'=>'rkc/directory/2_413/1',
				'wd-sy'=>'rkc/directory/2_198/1',
				'wdsj'=>'rkc/directory/2_44/1',
				'wow'=>'rkc/directory/2_5/1',
				'wzry'=>'rkc/directory/2_181/1',
				'xjzb'=>'rkc/directory/2_4/1',
				'xinyou'=>'rkc/directory/2_229/1',
				'xy'=>'rkc/directory/2_662/1',
				'yhzr'=>'rkc/directory/2_77/1',
				'yhzrkdb'=>'rkc/directory/2_77/1',
				'yinyue'=>'rkc/directory/2_311/1',
				'yuyin'=>'rkc/directory/2_422/1,rkc/directory/2_645/1,rkc/directory/2_435/1',
				'yingshi'=>'rkc/directory/2_208/1',
				'yanzhi'=>'rknc/directory/yzRec/1',
				'zhuji'=>'rkc/directory/2_19/1',
				'zhengnengliang'=>'rkc/directory/2_250/1'
			),
//			'c'=>array(
//				'blzy'=>'blzy',
//				'biaoyan'=>'yz',
//				'cf'=>'CF',
//				'cf-sy'=>'CFSY',
//				'cq'=>'cq',
//				'czymf'=>'ccymf',
//				'doudizhu'=>'hlddz,jj',
//				'dnf'=>'DNF',
//				'dota2'=>'DOTA2',
//				'ecy'=>'ecy',
//				'fifa'=>'FIFAOL4',
//				'gedou'=>'FTG',
//				'gjqtwlb'=>'gjqtwlb',
//				'gwlr'=>'gwlrsj',
//				'huaijiu'=>'classic',
//				'huwai'=>'HW',
//				'hyrz'=>'hyrz',
//				'jdqs'=>'jdqs',
//				'jl'=>'BladeSoul',
//				'jielan'=>'jl',
//				'jpfc'=>'jpfc',
//				'jw3'=>'jx3',
//				'lol'=>'LOL',
//				'lrs'=>'LRSZQ',
//				'lscs'=>'How',
//				'majiang'=>'HLMJ,mjll',
//				'meishi'=>'ms',
//				'miniworld'=>'MNSJ',
//				'mszb'=>'mszb',
//				'nba2k'=>'NBA2K',
//				'nsh'=>'nsh',
//				'nz'=>'NZ',
//				'qipai'=>'qipai',
//				'qqfc'=>'qqfcdy',
//				'qqfc-sy'=>'qqfcsy',
//				'qiuqiu'=>'qqdzz',
//				'qqxw-sy'=>'QQxwSY',
//				'roe'=>'roe',
//				'shuma'=>'smkj',
//				'srh'=>'srh',
//				'swxf'=>'Overwatch',
//				'tymyd'=>'tianya',
//				'ttkp'=>'ttkp',
//				'wd'=>'wddnb',
//				'wd-sy'=>'wd',
//				'wdsj'=>'MC',
//				'wow'=>'WOW',
//				'wzry'=>'wzry',
//				'xjzb'=>'SC',
//				'xinyou'=>'xyzx',
//				'yhzr'=>'COS',
//				'yhzrkdb'=>'yh',
//				'yinyue'=>'music',
//				'yuyin'=>'FM233',
//				'yingshi'=>'yqk',
//				'yanzhi'=>'yz',
//				'zhuji'=>'TVgame',
//				'zhengnengliang'=>'znl'
//			),
			'f'=>function($n){
				print_r($n);
				$a=array();
				$r=@$n['data']['rl'];
				if($r){
					foreach($r as $k=>$v){
						$a[]=array(
							't'=>$v['rn'],
							'a'=>'https://apic.douyucdn.cn/upload/'.$v['av'].'_middle.jpg',
							'h'=>'https://www.douyu.com/'.$v['rid'],
							'i'=>$v['rs16'],
							'p'=>$v['nn'],
							'n'=>$v['ol']*10,
							'nw'=>n2w($v['ol'])
						);
					}
				}
				return $a;
			},
//			'g'=>'#listAll li.layout-Cover-item',
//			'r'=>[
//				't'=>['.DyListCover-intro','title'],
//				'h'=>['.DyListCover-wrap','href','',function($n){
//					return 'https://www.douyu.com'.$n;
//				}],
//				'i'=>['.DyImg-content','src'],
//				'p'=>['.DyListCover-user','text'],
//				'n'=>['.DyListCover-hot','text','',function($n){
//					return w2n($n);
//				}],
//				'nw'=>['.DyListCover-hot','text']
//			]
		),
		'huya'=>array(
			'd'=>'https://www.huya.com',
			'z'=>'https://www.huya.com/g/',
			'c'=>array(
				'blzy'=>'3090',
				'biaoyan'=>'xingxiu',
				'cf'=>'cf',
				'cf-sy'=>'cfm',
				'chihewanle'=>'100044',
				'cq'=>'rxcq',
				'czymf'=>'2931',
				'doudizhu'=>'1749',
				'dnf'=>'2',
				'dota2'=>'dota2',
				'dwrg'=>'',
				'ecy'=>'2633',
				'fifa'=>'100079',
				'gjqtwlb'=>'1892',
				'gwlr'=>'3519',
				'hpjy'=>'3203',
				'huaijiu'=>'411',
				'huwai'=>'huwai',
				'hyrz'=>'hyrzsy',
				'jdqs'=>'2793',
				'jl'=>'bns',
				'jlbkm'=>'4375',
				'jpfc'=>'2563',
				'jw3'=>'900',
				'lol'=>'lol',
				'lrs'=>'LRSZQ',
				'lscs'=>'How',
				'majiang'=>'1751',
				'meishi'=>'ms',
				'mhls'=>'2758',
				'miniworld'=>'MNSJ',
				'mszb'=>'war3',
				'nba2k'=>'NBA2K',
				'nk'=>'2775',
				'nsh'=>'nsh',
				'nz'=>'nz',
				'ppkdc'=>'2620,popkart',
				'qipai'=>'qipai',
				'qqfc'=>'qqfc',
				'qqfc-sy'=>'qqfcsy',
				'qiuqiu'=>'qqdzz',
				'qqxw'=>'qqxw',
				'qqxw-sy'=>'2991',
				'roe'=>'3189',
				'sed'=>'2924',
				'sgs'=>'1669',
				'srh'=>'2755',
				'swxf'=>'overwatch',
				'tksj'=>'worldoftanks',
				'tymyd'=>'tymyd',
				'ttkp'=>'ttkp',
				'wd'=>'wd',
				'wd-sy'=>'2477',
				'wdsj'=>'MC',
				'wow'=>'wow',
				'wzry'=>'wzry',
				'xjzb'=>'starcraft',
				'xinyou'=>'100083',
				'yhzr'=>'yhzr',
				'yhzrkdb'=>'2760',
				'yinyue'=>'3793',
				'yuyin'=>'3799',
				'yingshi'=>'seeTogether',
				'yanzhi'=>'2168',
				'zhuji'=>'100032',
				'zhengnengliang'=>'znl'
			),
			'g'=>'#js-live-list li',
			'r'=>[
				't'=>['.title','title'],
				'h'=>['.title','href'],
				'i'=>['.pic','data-original'],
				'p'=>['.nick','text'],
				'n'=>['.js-num','text','',function($n){
					return w2n($n);
				}],
				'nw'=>['.js-num','text'],
				'a'=>['.avatar img','data-original']
			]
		),
		'longzhu'=>array(
			'd'=>'http://longzhu.com',
			'z'=>'http://longzhu.com/channels/',
			'c'=>array(
				'blzy'=>'fortnite',
				'biaoyan'=>'lzxc',
				'cf'=>'cf',
				'cf-sy'=>'cfmobile',
				'cq'=>'mir',
				'doudizhu'=>'hlddz',
				'dnf'=>'dnf',
				'dwrg'=>'dwrg',
				'ecy'=>'acg',
				'fifa'=>'fifaonline',
				'huaijiu'=>'pcgames',
				'huwai'=>'hwzb',
				'jdqs'=>'jdqs',
				'jpfc'=>'nfsol',
				'jl'=>'bns',
				'lol'=>'lol',
				'nba2k'=>'nba2k',
				'nz'=>'nz',
				'qqfc'=>'speed',
				'qqfc-sy'=>'qqfcsy',
				'swxf'=>'ow',
				'wdsj'=>'minecraft',
				'wow'=>'wow',
				'wzry'=>'wzry',
				'xjzb'=>'sc',
				'xinyou'=>'xyzq',
				'yhzr'=>'cos',
				'zhuji'=>'console',
				'zhengnengliang'=>'lzgy',
				'zuqiu'=>'zhzq'
			),
			'g'=>'#list-con a',
			'r'=>[
				't'=>['.listcard-caption','title'],
				'h'=>['','href'],
				'i'=>['.livecard-thumb ','src','',function($n){
					return str_replace('http://','//',$n);
				}],
				'p'=>['.livecard-modal-username','text'],
				'n'=>['.livecard-meta-views .livecard-meta-item-text','text','',function($n){
					return w2n($n);
				}],
				'nw'=>['.livecard-meta-views .livecard-meta-item-text','text','',function($n){
					return n2w($n);
				}],
				'a'=>['.livecard-avatar','src','',function($n){
					return str_replace('http://','//',$n);
				}]
			]
		),
//		'quanmin'=>array(
//			'd'=>'https://www.quanmin.tv',
//			'z'=>'https://www.quanmin.tv/game/',
//			'c'=>array(
//				'blzy'=>'baoleizhiye',
//				'cf'=>'cfpc',
//				'chihewanle'=>'chihewanle',
//				'cq'=>'chuanqi',
//				'dnf'=>'dnf',
//				'dwrg'=>'diwurenge',
//				'dota2'=>'dota2',
//				'ecy'=>'erciyuan',
//				'fifa'=>'fifa',
//				'huaijiu'=>'huaijiu',
//				'huwai'=>'chihewanle',
//				'hyrz'=>'huoying',
//				'hyxd'=>'huangyexingdong',
//				'jdqs'=>'juediqiusheng',
//				'jdqs-sy'=>'jdqssy',
//				'jl'=>'jianling',
//				'jielan'=>'fs',
//				'jw3'=>'jianxiaqingyuan',
//				'lol'=>'lol',
//				'lrs'=>'langrensha',
//				'lscs'=>'hearthstone',
//				'mszb'=>'war3',
//				'nba2k'=>'nba2k',
//				'nsh'=>'nishuihang',
//				'nz'=>'nizhan',
//				'qipai'=>'qipai',
//				'qqfc'=>'qqfeiche',
//				'qqfc-sy'=>'qqfeicheshouyou',
//				'qiuqiu'=>'qiuqiu',
//				'qqxw'=>'qqxuanwu',
//				'swxf'=>'overwatch',
//				'tksj'=>'tank',
//				'wdsj'=>'minecraft',
//				'wzry'=>'wangzhe',
//				'xinyou'=>'xinyouzhongxin',
//				'zhuji'=>'tvgame'
//			),
//			'g'=>'.list_w-videos_video-list li',
//			'r'=>[
//				't'=>['.common_w-card_title','text'],
//				'h'=>['.common_w-card_href','href'],
//				'i'=>['.common_w-card_cover','src'],
//				'p'=>['.common_w-card_host-name','text'],
//				'n'=>['.common_w-card_views-num','text'],
//				'nw'=>['.common_w-card_views-num','text','',function($n){
//					return n2w($n);
//				}],
//			]
//		),
//		'panda'=>array(
//			'd'=>'https://www.panda.tv',
//			'z'=>'https://www.panda.tv/cate/',
//			'c'=>array(
//				'blzy'=>'fortnite',
//				'biaoyan'=>'yzdr',
//				'cf'=>'cf',
//				'cf-sy'=>'cfm',
//				'cq'=>'legends',
//				'doudizhu'=>'doudizhu',
//				'dnf'=>'dnf',
//				'dwrg'=>'dwrg',
//				'dota2'=>'dota2',
//				'ecy'=>'acg',
//				'fifa'=>'fifa',
//				'gedou'=>'ftg',
//				'gjqtwlb'=>'gjqtol',
//				'gwlr'=>'mh',
//				'huaijiu'=>'hjjd',
//				'huwai'=>'hwzb',
//				'hyrz'=>'naruto',
//				'hyxd'=>'sycj',
//				'jdqs'=>'pubg',
//				'jdqs-sy'=>'pubgmo',
//				'jw3'=>'jxol3',
//				'lol'=>'lol',
//				'lrs'=>'werewolf',
//				'lscs'=>'hearthstone',
//				'majiang'=>'majiang',
//				'meishi'=>'food',
//				'mszb'=>'war3',
//				'nba2k'=>'nba2kol2',
//				'nsh'=>'nsh',
//				'qipai'=>'qipai',
//				'qqfc'=>'qqfc',
//				'qqfc-sy'=>'fcsy',
//				'qiuqiu'=>'qqdzz',
//				'roe'=>'roe',
//				'shuma'=>'technology',
//				'swxf'=>'overwatch',
//				'taiqiu'=>'billiards',
//				'tymyd'=>'tymyd',
//				'wdsj'=>'mc',
//				'wow'=>'wow',
//				'wzry'=>'kingglory',
//				'xjzb'=>'starcraft',
//				'xinyou'=>'newgames',
//				'yingshi'=>'cartoon',
//				'yinyue'=>'music',
//				'zhuji'=>'zhuji'
//			),
//			'g'=>'.video-list .video-no-cate',
//			'r'=>[
//				't'=>['.video-title','title'],
//				'h'=>['.video-list-item-wrap','href','',function($n){
//					return 'https://www.panda.tv/'.$n;
//				}],
//				'i'=>['.video-img','data-original'],
//				'p'=>['.video-nickname','title'],
//				'n'=>['.video-number','text','',function($n){
//					return w2n($n);
//				}],
//				'nw'=>['.video-number','text']
//			]
//		),
		'zhanqi'=>array(
			't'=>'json',
			'd'=>'https://www.zhanqi.tv',
			'z'=>'https://www.zhanqi.tv/api/static/v2.1/game/live/',
			'c'=>array(
				'blzy'=>'209/30/1.json',
				'cf'=>'120/30/1.json',
				'cq'=>'35/30/1.json',
				'doudizhu'=>'185/30/1.json',
				'dnf'=>'22/30/1.json',
				'dwrg'=>'194/30/1.json',
				'dota2'=>'10/30/1.json',
				'ecy'=>'126/30/1.json',
				'fifa'=>'36/30/1.json',
				'gedou'=>'70/30/1.json',
				'gwlr'=>'230/30/1.json',
				'hpyj'=>'247/30/1.json',
				'huaijiu'=>'73/30/1.json',
				'huwai'=>'184/30/1.json',
				'hyxd'=>'4/30/1.json,186/30/1.json',
				'jdqs'=>'106/30/1.json',
				'jw3'=>'32/30/1.json',
				'lol'=>'6/30/1.json',
				'lrs'=>'104/30/1.json',
				'lscs'=>'9/30/1.json',
				'mszb'=>'18/30/1.json',
				'nsh'=>'2/30/1.json',
				'qipai'=>'76/30/1.json',
				'qqfc-sy'=>'183/30/1.json',
				'qiuqiu'=>'127/30/1.json',
				'swxf'=>'82/30/1.json',
				'tksj'=>'79/30/1.json',
				'wdsj'=>'72/30/1.json',
				'wow'=>'8/30/1.json',
				'wzry'=>'115/30/1.json',
				'xjzb'=>'5/30/1.json',
				'zhuji'=>'49/30/1.json'
			),
			'f'=>function($n){
				$a=array();
				$r=@$n['data']['rooms'];
				if($r){
					foreach($r as $k=>$v){
						$a[]=array(
							't'=>$v['title'],
							'h'=>'https://www.zhanqi.tv'.$v['url'],
							'i'=>$v['spic'],
							'p'=>$v['nickname'],
							'n'=>$v['online'],
							'nw'=>n2w($v['online'])
						);
					}
				}
				return $a;
			}
		),
		// 'zhangyu'=>array(
		// 	'd'=>'http://www.zhangyu.tv',
		// 	'z'=>'http://www.zhangyu.tv/channeltypes/',
		// 	'c'=>array(
		// 		'huwai'=>'outdoors',
		// 		'lanqiu'=>'basketball',
		// 		'taiqiu'=>'billiards',
		// 		'zuqiu'=>'football'
		// 	),
		// 	'g'=>'.live-channel-panel li',
		// 	'r'=>[
		// 		't'=>['.channel-title','text'],
		// 		'h'=>['a','href','',function($n){
		// 			return 'http://www.zhangyu.tv'.$n;
		// 		}],
		// 		'i'=>['.ch-pic img','data-zimg'],
		// 		'p'=>['.channel-name','text'],
		// 		'n'=>['.channel-online','text','',function($n){
		// 			return w2n($n);
		// 		}],
		// 		'nw'=>['.channel-online','text','',function($n){
		// 			return n2w($n);
		// 		}],
		// 		'a'=>['.figurl','data-zimg']
		// 	]
		// ),
		// 'chushou'=>array(
		// 	'd'=>'https://www.chushou.tv',
		// 	'z'=>'https://www.chushou.tv/nav-list.htm?targetKey=',
		// 	'c'=>array(
		// 		'blzy'=>'3-1545-3',
		// 		'cf'=>'3-1147-3',
		// 		'cq'=>'3-1040-3',
		// 		'czymf'=>'3-1432-3',
		// 		'doudizhu'=>'3-1022-3',
		// 		'dnf'=>'3-1267-3',
		// 		'dwrg'=>'3-1606-3',
		// 		'ecy'=>'3-1353-3',
		// 		'fifa'=>'3-1189-3,3-1613-3,3-1614-3',
		// 		'hpjy'=>'3-1576-4',
		// 		'hyrz'=>'3-1175-3,3-1166-3',
		// 		'hyxd'=>'3-1541-3',
		// 		'jdqs'=>'3-1515-3',
		// 		'jielan'=>'3-1333-3',
		// 		'jw3'=>'3-1617-3',
		// 		'lol'=>'3-1435-3',
		// 		'lrs'=>'3-1386-3,3-1466-3,3-1387-3',
		// 		'lscs'=>'3-1003-3',
		// 		'majiang'=>'3-1035-3',
		// 		'mhls'=>'3-1603-4',
		// 		'miniworld'=>'3-1269-3',
		// 		'nba2k'=>'3-1190-3',
		// 		'nk'=>'3-1439-3',
		// 		'nsh'=>'3-1635-3',
		// 		'ppkdc'=>'3-1098-4',
		// 		'qmqz'=>'3-1009-3',
		// 		'qqfc-sy'=>'3-1409-3',
		// 		'qiuqiu'=>'3-1013-3',
		// 		'qqxw'=>'3-1601-3',
		// 		'swxf'=>'3-1436-3',
		// 		'tksj'=>'3-1204-3',
		// 		'ttkp'=>'3-1008-3,3-1186-3',
		// 		'tymyd'=>'3-1651-3',
		// 		'wd'=>'3-1173-3',
		// 		'wdsj'=>'3-1014-3',
		// 		'wzry'=>'3-1159-3',
		// 		'yhzrkdb'=>'3-1355-3',
		// 		'yqlfc'=>'3-1363-3',
		// 		'yanzhi'=>'3-1609-3'
		// 	),
		// 	'g'=>'#liveContent a',
		// 	'r'=>[
		// 		't'=>['.videoName','text'],
		// 		'h'=>['','href','',function($n){
		// 			return 'http://www.chushou.tv'.$n;
		// 		}],
		// 		'i'=>['.liveImages','data-imgsrc'],
		// 		'p'=>['.livePlayerName','text'],
		// 		'n'=>['.liveCount','text','',function($n){
		// 			return w2n($n);
		// 		}],
		// 		'nw'=>['.liveCount','text'],
		// 		'a'=>['.live_user_avatar','data-imgsrc']
		// 	]
		// ),
		'bilibili'=>array(
			'd'=>'https://live.bilibili.com',
			'z'=>'https://live.bilibili.com/p/eden/area-tags?',
			'c'=>array(
				'biaoyan'=>'parentAreaId=1&areaId=207'
			),
			'g'=>'.list li',
			'r'=>[
				't'=>['.room-title','text'],
				'h'=>['a','href','',function($n){
					return 'https://live.bilibili.com'.$n;
				}],
				'i'=>['.cover-ctnr','style','',function($backgroundImage){
					return '/static/image/default.png';
					// return preg_replace('/.*?url\((.*?)\);/','$1',$backgroundImage);
				}],
				'p'=>['.room-anchor span','text'],
				'n'=>['.popular-ctnr span','text','',function($n){
					return w2n($n);
				}],
				'nw'=>['.popular-ctnr span','text'],
				'a'=>['.avatar','style','',function($backgroundImage){
					return '/static/image/default.png';
					// return preg_replace('/.*?url\((.*?)\);/','$1',$backgroundImage);
				}]
			]
		),
		'bupt'=>array(
			'd'=>'http://ivi.bupt.edu.cn',
			'z'=>'http://ivi.bupt.edu.cn',
			'c'=>array(
				'dianshi'=>'/',
			),
			'g'=>'.well .2u',
			'r'=>[
				't'=>['p','text'],
				'h'=>['a:first','href','',function($n){
					return 'http://ivi.bupt.edu.cn'.$n;
				}],
				'hm'=>['a:last','href','',function($n){
					return 'http://ivi.bupt.edu.cn'.$n;
				}]
			]
		)
	)
);
$data=array();$html=array();$tip=array();
$mtfq_ar=explode('mtfq=',null !== @$_SERVER[REDIRECT_QUERY_STRING] ? @$_SERVER[REDIRECT_QUERY_STRING] : @$_SERVER['QUERY_STRING']);
$mtfq_ar=explode('?',end($mtfq_ar));
$_q=reset($mtfq_ar);
$t=array_keys($c['z']);
$n=$c['n'];

$p=preg_replace('/.*?&page=(\d+)/','$1',$_q);
$_q=preg_replace('/&page=(\d+)/','',$_q);
$p=is_numeric($p)?$p:1;

if($_q){
	header('Cache-Control: no-cache');//CDN不缓存，确保时效
	
	$a=explode('/',$_q);
	$s=explode(',',$a[0]);
	$_ar=array();
	foreach($s as $k=>$v){
		$_ar[]=$c['c'][$v]['n'];
		if(@$c['c'][$v]['tip']){
			$tip[]=$c['c'][$v]['tip'];
		}
	}
	$nc=implode('_',$_ar);
	if($a[1]){
		$t=explode(',',$a[1]);	
	}
	
	
	$h='cache/'.md5($_q).'.php';
	
	if(@$_POST['update']){
		$update=1;
	}else{
		if(file_exists($h)){
			include($h);
			if(time()-filemtime($h)>$c['t']){
				include('mtf/mtfHTTP/mtfHTTP.php');
				$mtfHTTP=new mtfHTTP();
				$mtfHTTP->curl(array('u'=>$_SERVER['HTTP_HOST'].'/'.$_q,'t'=>1,'p'=>array('update'=>1)));
				$tip[]='<span class="pure-button" onclick="location.reload()">正在更新，5-10秒后，点此刷新</span>';
			}
		}else{
			$update=1;
		}
	}
	
	if($update){
		set_time_limit(120);//2分钟
		require 'vendor/autoload.php';
		require 'mtf/mtfHTTP/mtfHTTP.php';

		foreach($s as $k1=>$v1){
			foreach($t as $k2=>$v2){
				$v=@$c['z'][$v2];
				if($v){
					$_ar=@$v['c'][$v1];
					if($_ar){
						$_ar=explode(',',$_ar);
						foreach($_ar as $k3=>$_c){
							if(@$v['t']==='json'){
								$mtfHTTP=new mtfHTTP();
								$_r=$mtfHTTP->curl(array('u'=>$v['z'].$_c));
								if($_r){
									$_a=json_decode($_r,TRUE);
									if($_a){
										print_r($_a);
										$data=array_merge($data,$v['f']($_a));
									}
								}
							}else{
								$_data=QL\QueryList::get($v['z'].$_c)->rules($v['r'])->range($v['g'])->query()->getData()->all();
								if(@$v['f']){
									$_data=$v['f']($_data);
								}
								//采集某页面所有的图片
								$data=array_merge($data,$_data);	
							}
						}
					}else{
						continue;
					}
				}else{
					continue;
				}
			}
		}
	}
	if(@$data){
		if($update){
			array_multisort(array_column($data, 'n'),SORT_NUMERIC, SORT_DESC, $data);
			@file_put_contents($h,'<?php $data='.var_export($data,TRUE).'?>');
		}
		$t=count($data);
		
		require 'mtf/Mobile_Detect/Mobile_Detect.php';
		$detect=new Mobile_Detect;
		$html=array_merge($html,array('data'=>array_slice($data,($p-1)*$c['p'],$c['p']),'query'=>'/'.$_q,'pages'=>mtfQueuePage($t,$c['p'],$p),'n'=>$c['n'].($p>1?'_第'.$p.'页':''),'nc'=>$nc,'PC'=>!$detect->isMobile()));
	}elseif(@$c['c'][$_q]){
		$tip[]='暂无主播在线';
	}
	
}else{
	function zhcnToPinyin($str)//汉字转拼音函数
	{
		if(empty($str)){return '';}
		$fchar=ord($str{0});
		if($fchar>=ord('A')&&$fchar<=ord('z')) return strtoupper($str{0});
		$s1=iconv('UTF-8','gb2312',$str);
		$s2=iconv('gb2312','UTF-8',$s1);
		$s=$s2==$str?$s1:$str;
		$asc=ord($s{0})*256+ord($s{1})-65536;
		if($asc>=-20319&&$asc<=-20284) return 'A';
		if($asc>=-20283&&$asc<=-19776) return 'B';
		if($asc>=-19775&&$asc<=-19219) return 'C';
		if($asc>=-19218&&$asc<=-18711) return 'D';
		if($asc>=-18710&&$asc<=-18527) return 'E';
		if($asc>=-18526&&$asc<=-18240) return 'F';
		if($asc>=-18239&&$asc<=-17923) return 'G';
		if($asc>=-17922&&$asc<=-17418) return 'H';
		if($asc>=-17417&&$asc<=-16475) return 'J';
		if($asc>=-16474&&$asc<=-16213) return 'K';
		if($asc>=-16212&&$asc<=-15641) return 'L';
		if($asc>=-15640&&$asc<=-15166) return 'M';
		if($asc>=-15165&&$asc<=-14923) return 'N';
		if($asc>=-14922&&$asc<=-14915) return 'O';
		if($asc>=-14914&&$asc<=-14631) return 'P';
		if($asc>=-14630&&$asc<=-14150) return 'Q';
		if($asc>=-14149&&$asc<=-14091) return 'R';
		if($asc>=-14090&&$asc<=-13319) return 'S';
		if($asc>=-13318&&$asc<=-12839) return 'T';
		if($asc>=-12838&&$asc<=-12557) return 'W';
		if($asc>=-12556&&$asc<=-11848) return 'X';
		if($asc>=-11847&&$asc<=-11056) return 'Y';
		if($asc>=-11055&&$asc<=-10247) return 'Z';
		return null;
	}
	$sort=array();$_py='';$cat=array();
	foreach($c['c'] as $k => $v) {
		$py=zhcnToPinyin($v['n']);
		$c['c'][$k]['py'] = $py;
		$c['c'][$k]['h'] = $k;
		$sort[] = $py;
	}
	array_multisort($sort, SORT_ASC, $c['c']);
	foreach($c['c'] as $k => $v){
		if($_py!==$v['py']){
			$cat[]=array('a'=>$v['py']);
			$_py=$v['py'];
		}
		$cat[]=$v;
	}
	$html=array('n'=>$c['n'],'nc'=>$c['n'],'cat'=>$cat);
}

if($tip){
	$html['tip']='<div>'.implode('</div><div>',$tip).'</div>';
}

if($html){
	include 'mtf/Mustache/Mustache.php';
	$Mustache=new Mustache_Engine();
	echo $Mustache->render(file_get_contents('tpl/c.tpl'), $html);
}else{
	//header('HTTP/1.1 404 Not Found');
	//header("status: 404 Not Found");
}


function mtfQueuePage($_total,$_per,$_page)
{
	$_r=array();
	if($_per){
		$_prev='上页';
		$_next='下页';
		$_p=ceil($_total/$_per);

		if($_p>1)
		{
			$_r[1]=array('p'=>1,'s'=>1);
			$_start=$_page>1?$_page-1:1;$_end=$_page+1<$_p?$_page+1:$_p;
			for ($_j=$_start; $_j<=$_end; $_j++) {
				$_r[$_j]=array('p'=>$_j,'s'=>$_j);	
			}

			$_a=floor(($_start-1)/2)+1;
			$_r[$_a]=array('p'=>$_a,'s'=>$_a);
			$_a=$_end+floor(($_p-$_end)/2);
			$_r[$_a]=array('p'=>$_a,'s'=>$_a);

			$_r[$_p]=array('p'=>$_p,'s'=>$_p);
			if($_page<=$_p)
			{
				if($_page>1){
					$_r[$_p+1]=array('p'=>$_page-1,'s'=>$_prev,'l'=>1);	
				}
				if($_page<$_p)
				{
					$_r[$_p+2]=array('p'=>$_page+1,'s'=>$_next,'l'=>1);	
				}
			}
			$_r[$_page]=@array_merge(@$_r[$_page],array('c'=>1));
			$_r[1]['p']=0;//第一页不显示page={page}
		}
	}
	ksort($_r);
	return array_values($_r);
}
function w2n($n){
	if(mb_stripos($n,'万')!==FALSE){
		$n=preg_replace('/[^0-9]/','',$n)*10000;
	}
	return $n;
}
function n2w($n){
	$w=$n/10000;
	if($w>=1){
		$n=round($w,2).'万';
	}
	return $n;
}
?>